# Sample config file for reportnew.

# Email address to receive notifications if specific address is not
# associated with a particular log.
master_notify: admin@domain

# Location of file containing current sizes of logs being monitored.
size_file: /etc/reportnew/reportnew.size

# Email sender of notifications
#email_sender: nobody@domain

# Use privilege separation.
privsep: no

# Signify signing key for signed file include macros
# (this line must precede any such macro)
# Public key must be in /etc/signify; .pub suffix will be
# added automatically if omitted.
# It's advised to set public key file and directory immutable.
#signify_pubkey: key.pub

# Preproc and postproc macro definitions
# macro_name = "value"[:append|substitute]
# Macro names can contain alphanumeric characters or - and _
# All macros are preproc macros, which can be referenced in match and
# exclude rules using %%macro_name%%.
# They are optionally postproc macros, which means the macro name will
# either be appended to the value when it appears in output, or
# substituted for the value when it appears in output.
# Macros are intended to be used for commonly used tokens such as
# IP and MAC addresses, public key identifiers, etc., that are used
# across many rules and may change from time to time (preproc) and/or
# are not clear/human-readable in output (postproc).
# Macros are parsed as regular expressions, so the following characters
# should be escaped with backslashes: plus, slash, period, asterisk,
# parentheses, left and right brackets.
# A list of macros can be included from a file in the same dir as config
# file using the directive:
#     macro-include-file: filename
# or  macro-include-signedfile: filename
# The latter of which must be signed with a signify key specified in the
# signify_pubkey directive, which must appear prior to the macro include
# directive. The context of the included macros (global or host) is the
# same as if the included file contents were at the same position in the
# config file.
# Possible use case: TLS certificate key fingerprints observed,
# using substitute or append options, for enrichment.
#
# A macro value can also be included from a file for macros defined either
# directly in the config file or via include files. They must also be in
# the same dir as the config file and are specified using the format
#  macro_name = "<file:filename>"
# If a macro value file contains multiple lines they will be
# concatenated with "|".
# To require that the file in question be signed with a signify key
# specified in the signify_pubkey directive, which must appear prior
# to the macro, use
#  macro_name = "<signedfile:filename>"
# The signature must be in filename.sig in the same dir as the config file.
# Possible use case: commonly observed domains in DNS queries, to exclude
# from matches and identify newly observed domains.
host_1 = "10\.0\.0\.1":append
computer_1_mac_addr = "ae:f0:b4:3b:83:a7":append
ssh_pub_key_1 = "JdufjdfFJUefenffdsjJJSJ":substitute
TLS_1_2 = "TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256":substitute
TLS_1_3 = "TLSv1.3:TLS_AES_256_GCM_SHA384:256":substitute
knownfingerprint1 = "SHA256:fpstring":substitute
knownfingerprint2 = "SHA256:fpstring":substitute

# For each log to monitor, give the following:
# log: [<logpath>]
# match: [all|/<regexp>/] (default all)
# exclude: [none|/<regexp>/] (default none)
# frequency: [all|daily|hourly] (default all)
# action: [notify <email>|text <email>|alert] (default notify [master_notify email])
# Multiple sets of match/exclude/action directives can be specified
# for each log.
# notify requires one or more email addresses (separated by commas), which
# will be sent a report.
# text requires one or more email addresses (separated by commas), which
# will be sent the raw logs (e.g., for text messaging).
# alert takes no additional arguments and displays output directly
# to STDOUT.

# Can define settings for multiple hosts in one file shared across multiple
# systems by using:
# hosts: [<host name list, space separated>]
# to identify which sections apply to which hosts.
# Old style multi-host configs are also still supported using:
# begin-host: [<hostname>]
# and
# end-host: [<hostname>]
# but that style requires significant redundancy for similarly configured
# systems. The two styles cannot be mixed.

### BEGIN /var/log/messages
log: /var/log/messages
match: /violation|fail|reject|denie|deny|refused|bsd: OpenBSD|sensorsd.*exceed|error|Error|Condition/
exclude: /newsyslog.*: logfile turned over/
action: notify admin@domain
### END /var/log/messages

### BEGIN /var/log/snort/portscan.log
log: /var/log/snort/portscan.log
match: all
exclude: none
action: notify admin@domain
### END /var/log/snort/portscan.log

### BEGIN /var/log/secure
log: /var/log/secure
match: all
exclude: /logfile turned over/
action: notify admin@domain
### END /var/log/secure

### BEGIN journal syslog-id doas (Linux)
log: journal syslog-id doas
match: /not permitted/
exclude: none
action: notify admin@domain
### END journal syslog-id doas (Linux)

### BEGIN /var/log/authlog
log: /var/log/authlog
match: /ROOT|sshd.*Connection|refused|deny|admin login|panic/
exclude: /ROOT LOGIN .* ON ttyC0|Threshold adjusted/
action: notify admin@domain

match: /snort/
exclude: none
action: notify admin@domain
### END /var/log/authlog

### BEGIN journal syslog-facility authpriv (Linux)
log: journal syslog-facility authpriv
match: /ROOT|refused|deny|panic/
exclude: /ROOT LOGIN .* ON tty1/
### END journal syslog-facility authpriv (Linux)

### BEGIN journal unit ssh.service (Linux)
log: journal unit ssh.service
match: /sshd.*Connection|Failed|invalid|not permitted|not from a permitted|refused|deny|admin login|panic/
exclude: /sshd.*Accepted keyboard-interactive\/pam for <knownuser> from <known-host>/
action: notify admin@domain
### END journal unit ssh.service (Linux)

### BEGIN /var/log/daemon
# example: ntpd, unbound, nsd, dhcpd
log: /var/log/daemon
match: /way too large|sanity|bad peer|terminating|exiting|unbound|nsd|dhcpd.*unknown/
exclude: /newsyslog.*: logfile turned over/
action: notify admin@domain
### END /var/log/daemon

### BEGIN journal syslog-facility daemon (Linux)
log: journal syslog-facility daemon
match: /way too large|sanity|bad peer/
exclude: none
action: notify admin@domain
### END journal syslog-facility daemon (Linux)

### BEGIN /var/log/maillog
# OpenSMTPD maillogs - non-session lines
log: /var/log/maillog
match: /reject|warn|error|panic|deny|fail|timeout|fatal|unverified|alert|bad certificate|bad signature/
# intentional error next line
exclude: /[a-f0-9]{16} (mda|mta|smtp)
action: notify admin@domain

# OpenSMTPD maillogs - mda logs (all single-line sessions)
match: /[a-f0-9]{16} mda
exclude: /result=Ok stat=Delivered/
action: notify admin@domain

# Provide context around these by matching other lines containing the
# envelope ID. The match: session-with matches all lines with a session
# ID, the exclude session-without line then removes any matching collections
# that don't include the requisite error components for the same session ID.
match: session-with /[a-f0-9]{16} (?:mta|smtp)/
exclude: session-without /([a-f0-9]{16}) (?:mta|smtp) (?:.*reject|warn|error|panic|deny|fail|timeout|fatal|invalid|bad signature|tls_ciphers=(?!%%TLS_1_3%%|%%TLS_1_2%%)|cert-check result=\"(?:valid|verified|unverified)\" fingerprint=\"(?!%%knownfingerprint1%%|%%knownfingerprint2%%).*\"))/
action: notify admin@domain
### END /var/log/maillog

log: /var/log/ntp
match: /way too large/
exclude: none
action: notify admin@domain

### BEGIN /var/www/logs/access.log
log: /var/www/logs/access.log
match: /strings-associated-with-admin|404/
exclude: /authenticated-users/
action: notify admin@domain
### END /var/www/logs/access.log

### BEGIN /var/www/logs/error.log
log: /var/www/logs/error.log
match: all
exclude: none
action: notify admin@domain
### END /var/www/logs/error.log

### BEGIN /var/account/acct
# BSD process accounting logs
# first, match anything from unknown users
log: /var/account/acct
match: all
exclude: /(__|tty..) (_dhcp |_file |_identd |_nsd |_ntp |_pflogd |_ping |_pkgfetch |_rad |_reportnew |_slaacd |_smtpd |_smtpq |_sndio |_spamd |_syslogd |_syspatch |_tcpdump |_traceroute |_unbound |user1 |nobody |root |sshd |www )/
action: notify admin@domain

# then, pledge and unveil violations
match: /^.*\[\d+\]\s+-\w+(P|U)/
exclude: none
action: notify admin@domain

# then, any unexpected commands from known users
match: /_dhcp/
exclude: /dhcpleased|dhcrelay/
action: notify admin@domain

match: /_file/
exclude: / file\[/
action: notify admin@domain

match: /_identd/
exclude: / identd/
action: notify admin@domain

match: /_nsd/
exclude: / nsd/
action: notify admin@domain

match: /_ntp/
exclude: / ntpd/
action: notify admin@domain

match: /_pflogd/
exclude: / pflogd/
action: notify admin@domain

match: /_pkgfetch/
exclude: / ftp/
action: notify admin@domain

match: /_ping/
exclude: / ping\[|ping6/
action: notify admin@domain

match: /_rad /
exclude: / rad\[/
action: notify admin@domain

match: /_reportnew /
exclude: / perl| smtpctl/
action: notify admin@domain

match: /_slaacd/
exclude: / slaacd/
action: notify admin@domain

match: /_smtpd/
exclude: / mail\.mboxf| sh\[| smtpctl| smtpd/
action: notify admin@domain

match: /_smtpq/
exclude: / smtpd/
action: notify admin@domain

match: /_sndio /
exclude: / sndiod/
action: notify admin@domain

match: /_spamd /
exclude: /ftp\[|pfctl| spamd|spamlogd/
action: notify admin@domain

match: /_syslogd/
exclude: / syslogd/
action: notify admin@domain

match: /_syspatch/
exclude: / cksum| ftp| sh\[| signify/
action: notify admin@domain

match: /_tcpdump/
exclude: / tcpdump/
action: notify admin@domain

match: /_traceroute/
exclude: / traceroute/
action: notify admin@domain

match: /_unbound/
exclude: / unbound/
action: notify admin@domain

match: /user1/
exclude: / basename|calc|chgrp| cp\[/
action: notify admin@domain

match: /root/
exclude: /accton|auth|login_pass/
action: notify admin@domain
### END /var/account/acct

### BEGIN /var/account/acct (macOS process accounting)
# This sample is for a macOS system.
# If this is the only log you monitor on macOS, you can run from a
# nonprivileged account.
# macOS seems to be more likely to display ?? for a tty in lastcomm
# output, so it's covered in the exclude on the rule for finding unknown
# users.
log: /var/account/acct
match: all
exclude: /(__|ttys\d+|\?\?) (_accesso |_analyti |_appinst |_appleev |_applepa |_assetca |_audiomx |_biome |_captive |_cmiodal |_coreaud |_corespe |_ctkd |_datadet |_diagnos | |_diskima |_distnot |_driverk |_fpsd |_gamecon |_hidd |_iconser |_install |_locatio |_lp |_mdnsres |_mds_sto |_modelma |_nearbyd |_netbios |_network |_neurale |_nsurlse |_oahd |_postfix |_reportm |_reportn |_reports |_rmd |_securit |_softwar |_spotlig |_timed |_trustd |_usbmuxd |_windows |nobody |root |unuseduser |user | adminuser )/

match: /_accesso /
exclude: /EAUpdaterS |UARPAssetM |accessoryu|cfprefsd |com\.apple\.|contactsd|containerm|distnoted| secd |secinitd |Thunderbol |trustd |UARPUpdate|uarpassetm|uarpd |xpcproxy /
action: notify admin@domain

match: /_analyti /
exclude: /analyticsd/
action: notify admin@domain

match: /_appinst /
exclude: /appinstall|cfprefsd |contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /_appleev /
exclude: /appleevent|contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /_applepa /
exclude: /cfprefsd|contactsd|distnoted |NFStorageS | nfcd | seld |xpcproxy /
action: notify admin@domain

match: /_assetca /
exclude: /AssetCache/
action: notify admin@domain

match: /_audiomx /
exclude: /audiomxd |cfprefsd|contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /_biome /
exclude: /biomed/
action: notify admin@domain

match: /_captive /
exclude: /captiveage/
action: notify admin@domain

match: /_cmiodal /
exclude: /appleh16ca|cameracapt|cfprefsd|com\.apple\.|contactsd|containerm|distnoted| secd |secinitd |trustd |UVCAssista |xpcproxy /
action: notify admin@domain

match: /_coreaud /
exclude: /AppleDevic |com\.apple\.|contactsd|coreaudiod|distnoted|xpcproxy /
action: notify admin@domain

match: /_corespe /
exclude: /corespeech/
action: notify admin@domain

match: /_ctkd /
exclude: / ctkd /
action: notify admin@domain

match: /_datadet /
exclude: /xpcproxy /
action: notify admin@domain

match: /_diagnos /
exclude: /diagnostic|xpcproxy /
action: notify admin@domain

match: /_diskima /
exclude: /diskimages|xpcproxy /
action: notify admin@domain

match: /_distnot /
exclude: /distnoted/
action: notify admin@domain

match: /_driverk /
exclude: /com\.apple\.|IOUserBlue|xpcproxy /
action: notify admin@domain

match: /_fpsd /
exclude: /adid |fairplayd/
action: notify admin@domain

match: /_gamecon /
exclude: /contactsd|distnoted|gamecontro |xpcproxy /
action: notify admin@domain

match: /_hidd /
exclude: / hidd /
action: notify admin@domain

match: /_iconser /
exclude: /iconservic/
action: notify admin@domain

match: /_install /
exclude: /cfprefsd|contactsd|containerm|distnoted|installcoo | pkd |xpcproxy /
action: notify admin@domain

match: /_locatio /
exclude: /cfprefsd|com\.apple\.|contactsd|containerm|distnoted|locationd | secd |secinitd|trustd |xpcproxy /
action: notify admin@domain

match: /_lp /
exclude: /bluetooth |cgpdftoras |contactsd |cups-devic |cups-drive |cups-exec |epsonfax |xpcproxy /
action: notify admin@domain

match: /_mdnsres /
exclude: /mDNSRespon/
action: notify admin@domain

match: /_mds_sto /
exclude: /mds_stores/
action: notify admin@domain

match: /_modelma /
exclude: /cfprefsd|contactsd|distnoted|HostInfere|modelmanag |xpcproxy /
action: notify admin@domain

match: /_nearbyd /
exclude: /nearbyd/
action: notify admin@domain

match: /_netbios /
exclude: /netbiosd|xpcproxy /
action: notify admin@domain

match: /_neurale /
exclude: /ANEStorage|aneuserd|cfprefsd|contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /_nsurlse /
exclude: /STExtracti |cfprefsd|com\.apple\.|contactsd|distnoted|nsurlsessi|xpcproxy /
action: notify admin@domain

match: /_oahd /
exclude: / oahd |oahd-helpe/
action: notify admin@domain

match: /_postfix /
exclude: /cleanup |pickup |qmgr |showq |smtp |trivial-re /
action: notify admin@domain

match: /_reportm /
exclude: /ReportMemo |xpcproxy /
action: notify admin@domain

# _reportnew
match: /_reportn /
exclude: /perl /
action: notify admin@domain

match: /_reports /
exclude: /ReportSyst|xpcproxy /
action: notify admin@domain

match: /_rmd /
exclude: /cfprefsd|contactsd|DiskManage|distnoted|Interactiv|LegacyProf|ManagedApp|ManagedCon|Management|PasscodeSe|remotemana|ScreenShar|SecuritySu|SoftwareUp|xpcproxy /
action: notify admin@domain

match: /_securit /
exclude: /cfprefsd|contactsd|distnoted|MTLCompile |SecurityAg |xpcproxy /
action: notify admin@domain

match: /_softwar /
exclude: /cfprefsd|contactsd|distnoted|softwareup|xpcproxy /
action: notify admin@domain

match: /_spotlig /
exclude: /contactsd|distnoted|mdworker |mdworker_s| secd |trustd |xpcproxy /
action: notify admin@domain

match: /_timed /
exclude: /timed/
action: notify admin@domain

match: /_trustd /
exclude: / trustd /
action: notify admin@domain

match: /_usbmuxd /
exclude: / usbmuxd /
action: notify admin@domain

match: /_windows /
exclude: /contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /nobody /
exclude: /dhcp6d |xpcproxy /
action: notify admin@domain

match: /root /
exclude: /ANECompile |ANEStorage |ASPCarryLo |AirPlayXPC |AppSSODaem |AppleCrede |AppleDevic |AssetCache |AudioCompo |BlockBlock |CVMServer |Categories |CloudTelem |ContextSer |CrashRepor |DesktopSer |FindMyMacd |GSSCred |GoogleUpda |IOMFB_bics |ImageIOXPC |InternetSh |KernelEven |MCXDiskSet |MTLCompile |ManagedCli |NANDTaskSc |PerfPowerS |PerfPowerT |PlugInLibr |PowerUIAge |ReportCras |SCHelper |SubmitDiag |UserEventA |UserSelect |ViewBridge |WiFiAgent |WiFiCloudA |WindowServ |WirelessRa |XProtect |XProtectBr |XProtectPl |XProtectRe |XProtectUp |XprotectSe |accton |activateSe |airportd | akd |amfid | aned |apfsd |applekeyst |applessdst | apsd |aslmanager |assetsubsc |audioanaly |audioclock |authd |authorizat |autofsd |automount |automountd |background |backupd |backupd-he |basename | bash |betaenroll |biometrick |bluetoothd |bootinstal |bsdtar |bzip2 | cat |cfprefsd |chmod |chown |clang |cloudd |colorsync. |colorsyncd |com\.apple\. |com.object |configd |contactsd |containerm |contextsto |coreauthd |corebright |corecaptur |coreduetd |corekdld |corerepair |coreservic |coresymbol |countryd | cp |cryptexd |csrutil |ctkahp | ctkd |cupsd |cups-exec |cups-devic | curl | cut | dasd |defaults |deleted_he |deviceinte |digest-ser |dirhelper |dirname |diskarbitr |diskimages |distnoted |dprivacyd |ecosystema |ecosystemd |efilogin-h |eligibilit |emacs-29.4 |endpointse | env |extensionk|familycirc |filecoordi | find |findmybeac |findmydevi |fsck_hfs |fseventsd |fskit_help |fskitd |gamepolicy |getconf | git |gktool | grep |griddatad |hdiejectd |hdiutil | heap |hfs\.util |iconservic |imklauncha |installd |install_mo | ipp |kernelmana |kextstat |keybagd |killall |kmutil |ksadmin |ksinstall |lastatus |lastcomm |launchctl |launchd |launcher |launchserv |liquiddete |locale | logd |logd_helpe |logd_repor |logind |loginwindo |logkextloa | ls | lsd |lsof ||mDNSRespon | make |managedapp |master |mdmclient | mds |mdsync |mediaremot |microstack |mkdir |mmaintenan |mobileacti |mobileasse |modelcatal |mount |mount_hfs | more | mv |nbagent |nbstated |nehelper |nesessionm |netavark |newsyslog |notifyd |od_user_ho |online-aut |opendirect |osanalytic |ospredicti |peakpowerm | perl | pfd | pkd |postdrop |postqueue |powerd |powerdatad |powerexper |profiles | ps | pwd |remoted |revisiond |rpcsvchost |rsync |rtcreporti |runningboa |sandboxd |searchpart |secinitd |securityd |securityd_ | sed |sendmail |sessionlog | sh |sharedfile |shove |shutdown |signpost_r |smb-sync-p | smd |socketfilt |spctl |spindump | stat |storagekit | sudo |suhelperd |sw_vers |swift-insp |symptomsd- |sysctl |sysdiagnos |sysextd |syslog |syslogd |sysmond |syspolicyd |system_ins |systemmigr |systemsoun |systemstat |taskgated- | tccd | tee |thermalmon |threadradi | top |touch | tr |triald_sys | true |trustdFile | tzd | uncd |universala |usbcteleme |usermanage |vmnet-brid |vmnet-cli |vmnet-dhcp |vmnet-natd |vmware-id |vmware-usb | wall |wallpapere |warmd |watchdogd |which |wifianalyt |wifip2pd |xattr |xcode-sele |xcrun |xpcproxy | zsh /
action: notify admin@domain

match: /unuseduser /
exclude: /cfprefsd |contactsd|containerm|distnoted| lsd |mdbulkimpo |mdworker_s | pkd | secd |trustd |xpcproxy /
action: notify admin@domain

match: /user /
exclude: /ABAssistan |AMPArtwork |AMPDeviceD |AMPLibrary |AOSHeartbe |APFSUserAg |ASConfigur |AUCrashHan |AXVisualSu |Accessibil |AccountSub |AddPrinter |AddressBoo |AirPlayUIA |AirScanSca |AppPredict |AppSSOAgen |AppleIDSet |AppleSpell |Applicatio |AquaAppear |AssetCache |AssetMetri |AudioCompo |Authentica |Automator |AvatarPick |Background |BatteriesA |BiomeAgent |BiomeSELFI |BitacoraWo |BlockBlock |BooksStora |CGPDFServi |CMFSyncAge |CSExattrCr |CVMCompile |CacheDelet |Calendar |CalendarFi |CalendarIn |CalendarWi |CallHistor |Categories |ClassroomS |CloudDocsS |CloudKeych |CloudStora |CloudTelem |CloudWorke |CommCenter |Contacts |ContextSer |ContextSto |Continuity |ControlCen |CoreLocati |CoreServic |CoreThread |Credential |CursorUIVi |DPSubmissi |DataDetect |DefaultExt |DeveloperS |DeviceProp |DiskUnmoun |DisplayCon | Dock |EscrowSecu |Experiment |FPCKServic |FSKitModul |FaceTimeEx |Family |FamilySett |FeatureAcc |FedStatsML |Finder |FindMyWidg |FollowUpSe |GMSSELFIng |GPGSuite_U |GarageBand |GeneralSet |Google Chr |GoogleUpda |HeadphoneS |HomeEnergy |IFTelemetr |IFTranscri |IMAutomati |IMDPersist |IMTransfer |Image Capt |ImageIOXPC |InferenceE |Install in |Installer |InstallerT |Intelligen |Interactiv |JournalWid |Keychain C |KonaSynthe |LWAnalytic |LegacyPlug |LegacyProf |LocalAuthe |LoginItems |LoginUserS |MENotifica |MTLAssetUp |MTLCompile |MacPodcast |MacinTalkA | Mail |MailCacheD |MailStorag |Managed Ba |ManagedApp |ManagedSet |Management |Maps |MauiAUSP |MediaExten |MediaMLExt |Messages |Messages S |MessagesAc |MessagesAi |MessagesAn |MessagesHe |MetricsExt |MobileTime |ModelCatal |MonogramPo |MusicCache |MusicStora |Network |NewsTag |NewsTodayI |NewsToday2 |Notes |Notificati |Numbers |ODDIExperi |ODDIMetric |ODDIPoirot |Open VMwar |OtherUsers |PAH_Extens |PackageThu |PasscodeSe |PasswordBr |PeopleWidg |Photos |PhotosReli |PhotosStor |PlugInLibr |PnROnDevic |PodcastCon |PodcastWi |Preview |Print Cent |PrinterSca |Problem Re |ProtectedC |QuickLookS |QuickLookU |RecordWidg |RemoteCata |RemoteMana |Repackagin |RemindersW |ReportCras |SAExtensio |SafariAssi |SafariBook |SafariConf |SafariLaun |SafariLink |SafariWidg |ScopedBook |ScreenShar |ScreenTime |SecurityAg |SecuritySu |SetStoreUp |SettingsSy |ShortcutsV |ShortcutsW |SiriAUSP |SiriSugges |SiriTurnRe |SiriUserSe |SoftwareUp |SpeechData |SpeechSynt |Spotlight |StatusKitA |StocksKitS |StocksWidg |StorageMan |System Inf |System Set |SystemUISe |TMHelperAg |TVCacheExt |TVStorageE |TelemetryA |Terminal |TextInputM |TextInputS |TipsWidget |TrashStora |TrialArchi |TrustedPee |UIKitSyste |UniversalC |UsageTrack |UserEventA |UserNotifi |UserSelect |VMware Fus | VPN |VTDecoderX |VTEncoderX |ViewBridge |VoiceMemos |WallpaperA |WardaSynth |WeatherIng |WeatherWid |Wi-Fi |WiFiAgent |WiFiCloudA |WindowMana |WorldClock |XPCKeychai |XProtect |XProtectPl |XProtectRe |XprotectSe ||accountsd |adprivacyd | akd |amsaccount |amsengagem |amsondevic |analyticsa |appleaccou |appplaceho |appstoreag |askpermiss |assistant_ |assistantd |audioacces |avatarsd |avconferen | awk |axassetsd |background |basename | bash |betaenroll |biomesyncd | bird |bluetoothu |businessse |calaccessd |callintell |callservic | cat | cdpd |cfprefsd |chrome_cra |chronod |ciphermld |cloudd |cloudphoto |colorsync\. |com\.apple\. |com\.vmware |commandInk |commerce |communicat |contactsd |contactsdo |containerm |contentlin |coreautha |coreauthd |corespeech |corespotli | cp |crashhelpe |csnameddat |ctkahp | ctkd |cups-exec |dataaccess | date |defaults |deleted |devicechec |diagnostic |diskimages |distnoted | dmd |donotdistu |dprivacyd |duetexpert |ecosystema |exchangesy |extensionk |familycirc |feedbackd |fileprovid |filevaultd |financed | find |findmyloca |firefox |followupd |fontd |fontworker |frauddefen |fskit_agen |fudHelperA |gamecontro |generative |geoanalyti |geodMachSe |go-nfsv4-1 |hdiutil |head |helpd |homed |homeenergy |iCloudNoti |iOSFilesSt | icdd |icloudmail |iconservic |identityse |imagent |imklauncha |inputanaly |intelligen |intents_he |ipp2ppd |itunesclou |jetpackass |keyboardse |keychainsh |knowledge- |knowledgec |ksadmin |launcher |less |linkd |liveactivi |locale |localizati |localspeec |lockdownmo |login |loginitemr | ls | lsd |maild |managedapp |managedcor |mandoc |mapssyncd |mdbulkimpo |mdmclient |mdworker |mdworker_s |mdwrite |media-inde |mediaanaly |mediaremot |metrickitd |milod |mkdir |mlhostd |mlruntimed |mobilerepa |mobiletime |mscamerad |mscamerad- |naturallan |nbagent |ndoagent |neagent |networkser |nsattribut |nsurlsessi |org\.mozill |otherbsd |parsec-fbf |parsecd |passd |path_helpe |pboard | pbs |peopled |photoanaly |photolibra |pingsender | pkd |pkgutil |pkreporter |plugin-con |postersync |privateclo |proactived |proactivee |profiles |progressd |promotedco | ps |ptcamerad |rapportd |recentsd |remindd |replayd |replicator |reversetem |routined | scp |screencapt |searchpart | secd |secinitd |securityup |seedusaged | seq |seserviced | sh |sharedfile |sharingd |shlock |siriaction |siriinfere |siriknowle |sirittsd |sleep |snmp |sociallaye |spindump_a |spotlightk | ssh |ssh-agent |storekitag |stty |studentd |suggestd | swcd |swtranspar |syncdefaul |system_pro |systemsett | tail |talagentd | tccd |textunders |tipsd |touch |translatio |transparen |triald |trustd |umount |universala |useractivi |usernoted |usernotifi |vmware-vmx |voicebanki |warmd_agen | wc |weatherd |webprivacy |xattr |xcode-sele |xpcproxy | zcat | zsh /
action: notify admin@domain

match: /adminuser /
exclude: /AMPArtwork |AMPDeviceD |AMPLibrary |AOSHeartbe |APFSUserAg |ASConfigur |AUCrashHan |AXVisualSu |Accessibil |AccountSub |AddressBoo |AirPlayUIA |AppPredict |AppleSpell |AquaAppear |AssetCache |AssetMetri |AudioCompo |Authentica |Background |BatteriesA |BiomeAgent |BiomeSELFI |BitacoraWo |CMFSyncAge |CacheDelet |CalendarIn |CalendarWi |CallHistor |CarbonComp |Categories |CloudKeych |CloudTelem |CloudWorke |CommCenter |ContextSer |ContextSto |Continuity |ControlCen |CoreLocati |CoreServic |CoreThread |CursorUIVi |DeviceProp | Dock |EscrowSecu |Experiment |FeatureAcc |FindMyWidg |Finder |GMSSELFIng |GPGSuite_U |HomeEnergy |HomeWidget |IFTelemetr |IFTranscri |IMDMessage |IMDPersist |IMTransfer |ImageIOXPC |Intelligen |Interactiv |JournalWid |Keychain C |KonaSynthe |LegacyProf |LoginUserS |MENotifica | MRT |MTLAssetUp |MTLCompile |MacinTalkA |MailCacheD |ManagedApp |ManagedSet |Management |MauiAUSP |MediaMLExt |MessagesAc |MessagesAi |MessagesAn |MetricsExt |MobileTime |ModelCatal |MusicCache |NewsTag |NewsToday2 |NewsTodayI |Notificati |ODDIExperi |ODDIMetric |ODDIPoirot |PasscodeSe |PasswordBr |PeopleWidg |PhotosReli |PlugInLibr |PnROnDevic |PodcastsWi |ProtectedC |QuickLookU |RecordWidg |RemindersW |RemoteMana |ReportCras |SAExtensio |Safari |SafariAssi |SafariBook |SafariConf |SafariLaun |SafariLink |SafariNoti |SafariWidg |ScopedBook |ScreenShar |ScreenTime |SecuritySu |SetStoreUp |ShortcutsV |ShortcutsW |SiriAUSP |SiriSugges |SoftwareUp |SpeechSynt |Spotlight |StatusKitA |StocksKitS |StocksWidg |SystemUISe |TVCacheExt |TelemetryA |Terminal |TextInputM |TextInputS |TipsWidget |TrialArchi |TrustedPee |UIKitSyste |UniversalC |UsageTrack |UserEventA |UserNotifi |VTDecoderX |ViewBridge |VoiceMemos |WallpaperA |WardaSynth |WeatherInt |WeatherWid |WiFiAgent |WiFiCloudA |WindowMana |WorldClock |XProtect |XProtectPl |accountsd |adprivacyd | akd |amsaccount |amsengagem |amsondevic |analyticsa |appleaccou |appplaceho |appstoreag |askpermiss |assistant_ |assistantd |audioacces |avconferen |axassetsd |background | bash |betaenroll |biomesyncd | bird |bluetoothu |bsdtar |businessse |calaccessd |callservic | cat | cdpd |cfprefsd |chmod |chronod |clang |cloudd |cloudphoto |com\.apple\. |commerce |communicat |contactsd |containerm |contentlin |coreautha |coreauthd |corespeech |corespotli | cp |csnameddat |ctkahp | ctkd | curl |dataaccess | date |deleted |devicechec |diagnostic |dirname |distnoted | dmd |donotdistu |duetexpert |ecosystema | env |exchangesy |extensionk |familycirc |feedbackd |fileprovid |filevaultd |financed | find |findmyloca |followupd |fontd |fontworker |frauddefen |fudHelperA |gamecontro |generative |geoanalyti |geodMachSe |getconf | git |git-remote | grep |heard |helpd |homed |homeenergy |iCloudNoti | icdd |iconservic |identityse |imagent |imklauncha |inputanaly |intelligen |intents_he |itunesclou |jetpackass |keyboardse |keychainsh |knowledge- |lastcomm |linkd |liveactivi |locale |localizati |localspeec |locationac |lockdownmo |lockf |login | ls | lsd |maild | make |managedapp |mapssyncd |mdbulkimpo |mdfind |mdmclient |mdworker |mdworker_s |media-inde |mediaanaly |mediaremot |mediashari |milod |mkdir |mlhostd |mobilerepa |mobiletime | more |naturallan |nbagent |ndoagent |neagent |networkser |nsurlsessi |otherbsd |parsec-fbf |parsecd |passd |path_helpe |pboard | pbs |pcdCheck |peopled | perl |photoanaly |photolibra | pkd |pkgutil |postersync |privateclo |proactived |proactivee |progressd |promotedco | ps | pwd |rapportd |readlink |recentsd |remindd |replayd |replicator |routined | ruby |searchpart | secd |secinitd |securityup | sed |seedusaged |seserviced | sh |sharedfile |sharingd |shlock |siriaction |siriinfere |siriknowle |sirittsd |sociallaye |spotlightk | stty | sudo |suggestd |sw_vers | swcd |swtranspar |syncdefaul |sysctl |systemsett |talagentd | tccd | tee |tipsd |touch | tr |translatio |transparen |triald | true |trustd |universala |useractivi |usernoted |usernotifi |voicebanki | w |warmd_agen | wc |weatherd |webprivacy |xcode-sele |xcrun |xpcproxy | zsh /
action: notify admin@domain

### END /var/account/acct (macOS process accounting)

### BEGIN /var/log/account/pacct (Linux process accounting)
# This sample is for a Proxmox (Debian) system.
log: /var/log/account/pacct
match: all
exclude: /(__|pts\/\d|tty\d) (_apt |_chrony |man |message\+ |postfix |_rpc |_reportnew |root |sshd |www-data )/
action: notify admin@domain

# then, any unexpected commands from known users, just as for BSD-style
match: /_apt /
exclude: /http | sqv |store /
action: notify admin@domain

match: /_chrony /
exclude: /chronyd/
action: notify admin@domain

match: /man /
exclude: /mandb /
action: notify admin@domain

match: /message\+ /
exclude: /dbus-daemon/
action: notify admin@domain

# avoid matching postfix commands, we just want the user, wish it had a leading _.
match: /__ postfix /
exclude: /cleanup|pickup |postsuper|qmgr | smtp |tlsmgr |trivial-rewrite/
action: notify admin@domain

match: /_rpc /
exclude: /rpcbind/
action: notify admin@domain

match: /_reportnew /
exclude: /perl /
action: notify admin@domain

# avoid matching sshd command, we just want the user, wish it had a leading _.
match: /__ sshd /
exclude: /sshd-auth/
action: notify admin@domain

match: /www-data /
exclude: / ip |pveproxy |spiceproxy /

match: /root /
exclude: /30-systemd-envi| ac |acct |accton|activate-storag|apparmor_parser|apt-config|apt-get|apt-helper|apt\.systemd\.dai|awk|basename|bash|blkmapd|brctl|bridge|cached_setup_te|cat |call_rcu|chattr|chmod |chown |chrony |chronyc| cp | cmp |configure-insta|cron|cut |d-logind|date |dirname|dmsetup|dpkg |dpkg-db-backup|e2scrub_all|ebtables-(restor|save)|expr |ext4lazyinit|fido_id |find |flock|fstrim |grep |grotty|grub-editenv|gzip |hdparm|http | id |install |invoke-rc.d|iptables-(restor|save)|ip6tables-(resto|save)| ip |ipset |iscsiadm |iscsid |journalctl|kpatrx_id|ksmtuned|kvm |kvm-nx-lpage-re|kvm-pit|kworker|last |local|logger|logrotate|login| ls |lsattr |lsblk |lvchange|lvm |lvs |lxc-apparmor-lo|lxc-autostart|lxc-containers|lxc-net|man |master|mini-journalrea|mkdir|mktemp|modprobe|more |mount|multipath| mv |net-interface-h|netavark|nfsrahead|nft |nroff|pager|partx|perl|pmxcfs|postconf|postdrop|postfix |postfix-script|preconv|profile-load| ps |psimon|pve-bridge|pve-firewall |pve-firewall-co|pve-ha-crm|pve-ha-lrm|pve-sdn-commit|pve-startall-de|pvebanner|pvecm|pvedaemon|pvescheduler|pvesh|pvestatd |python3| qm |qmeventd|query-machine-c|readlink|realpath|rsync|run-parts|savelog|sd-close|sd-exec-strv|sd-mkdcreds|sd-mkuserns|sd-pam|sd-rmrf|\(sd-sync\)| sed |sendmail|sg_inq| sh |signify-openbsd|sleep|sm-notify|sort | ss |sshd |\(sshd\)|sshd-session| sqv |startup-checks\.|start-networkin| stat | store | stty |syncfiles\.pl|sysctl|syslock|systemctl|systemd |systemd-detect-|systemd-rfkill|systemd-run|systemd-sysctl|systemd-tmpfile|systemd-tty-ask|systemd-user-ru|systemd-user-se|systemd-xdg-aut|sysunlock| tar |task UPID:pve:0|tbl | tc |termproxy|touch|troff| tr |true|udev-worker|udevadm|uname|unix_chkpwd|update-alternat|vdev_id|vgs |vgscan|virtual-functio|wtmpdb|xfs_scrub_all|zfs /
action: notify admin@domain

### END /var/log/account/pacct
