# Sample config file for reportnew.

# Email address to receive notifications if specific address is not
# associated with a particular log.
master_notify: admin@domain

# Location of file containing current sizes of logs being monitored.
size_file: /etc/reportnew/reportnew.size

# Email sender of notifications
#email_sender: nobody@domain

# Use privilege separation.
privsep: yes

# Signify signing key for signed file include macros
# and any executable scripts.
# (this line must precede any such macro)
# Public key must be in /etc/signify; .pub suffix will be
# added automatically if omitted.
# It's advised to set public key file and directory immutable.
#signify_pubkey: key.pub

# Preproc and postproc macro definitions
# macro_name = "value"[:append|substitute]
# Macro names can contain alphanumeric characters or - and _
# All macros are preproc macros, which can be referenced in match and
# exclude rules using %%macro_name%%.
# They are optionally postproc macros, which means the macro name will
# either be appended to the value when it appears in output, or
# substituted for the value when it appears in output.
# Macros are intended to be used for commonly used tokens such as
# IP and MAC addresses, public key identifiers, etc., that are used
# across many rules and may change from time to time (preproc) and/or
# are not clear/human-readable in output (postproc).
# Macros are parsed as regular expressions, so the following characters
# should be escaped with backslashes: plus, slash, period, asterisk,
# parentheses, left and right brackets.
# A list of macros can be included from a file in the same dir as config
# file using the directive:
#     macro-include-file: filename
# or  macro-include-signedfile: filename
# The latter of which must be signed with a signify key specified in the
# signify_pubkey directive, which must appear prior to the macro include
# directive. The context of the included macros (global or host) is the
# same as if the included file contents were at the same position in the
# config file.
# Possible use case: TLS certificate key fingerprints observed,
# using substitute or append options, for enrichment.
#
# A macro value can also be included from a file for macros defined either
# directly in the config file or via include files. They must also be in
# the same dir as the config file and are specified using the format
#  macro_name = "<file:filename>"
# If a macro value file contains multiple lines they will be
# concatenated with "|".
# To require that the file in question be signed with a signify key
# specified in the signify_pubkey directive, which must appear prior
# to the macro, use
#  macro_name = "<signedfile:filename>"
# The signature must be in filename.sig in the same dir as the config file.
# Possible use case: commonly observed domains in DNS queries, to exclude
# from matches and identify newly observed domains.

# Global Macros.
# root command macros.
# general + Linux (lx) and OpenBSD (ob) variants
ACCTroot = "accton|lastcomm| sa\["
lxACCTroot = " ac\[|acct\[|accton"
ARCHIVEroot = " ar\[|gunzip|gzip\[| tar\[| zcat\[|zgrep"
lxARCHIVEroot = "gzip| tar\["
COREUTILSroot = " awk\[|basename| cat\[|chmod\[|chgrp\[|chown\[| cp\[| cmp\[| cut\[|date\[|dirname| expr\[|find\[| grep\[|hostname| id\[|install\[|less| ln\[| ls\[|mkdir|mktemp|more\[| mv\[| ps\[|readlink| sed\[|sleep| sort\[| stat\[|touch| tr\[| true\[|uname"
lxCOREUTILSroot = " last\[|pager|realpath| stty\["
obBOOTroot = " ld\[|ldconfig|objcopy|sysctl"
obCRYPTOroot = "cksum| gpg\[|sha256|signify"
lxCRYPTOroot = "gpg-agent|gpgconf|signify-openbsd| sqv\["
obDEVroot = " arch\[| cc\[| clang\[| conftest\[| cpp\[| dwz\[| env\[| fgrep\[| gmake\[| install-info\[| make\[| makewhatis\[| patch\[| pkg-config\[| ranlib\[| readelf\[| yat2m\["
obDISKFSroot = "disklabel|dump|fdisk|mount\[|mount_ffs|umount"
obDJBTOOLSroot = "setuidgid|softlimit|supervise| svc\[|svscan|svstat"
obDNSSERVERroot = " nsd\[|nsd-checkconf|nsd-control|nsd-zonec|unbound\[|unbound-checkconf|unbound-control"
lxDOCroot = "grotty| man\[|man-db|nroff|preconv| tbl\[|troff"
lxCHRONroot = "chrony\[|chronyc|cron|run-parts"
lxDISKroot = "blkmapd|dmsetup|hdparm|kpartx_id|lsblk\[|lvchange| lvm\[| lvs\[|partx\[|vdev_id| vgs\[|vgscan"
lxFSroot = "e2scrub_all|ext4lazyinit|flock|fstrim|fuse_worker|mount\[|nfsrahead|sm-notify|xfs_scrub_all| zfs\["
lxIMMUTABLEroot = "chattr|lsattr|syslock|sysunlock"
lxISCSIroot = "iscsiadm\[|iscsid\[|multipath\[|sg_inq"
lxKERNELroot = "apparmor_parser|call_rcu|kworker|modprobe|sysctl|udev-worker|udevadm"
lxKVMroot = "kvm\[|kvm-nx-lpage-re|kvm-pit"
lxLANGroot = "perl\[|python3"
lxLOGGINGroot = "journalctl|logger|logrotate|mini-journalrea|reportnew|savelog|wtmpdb"
# pkill part of pflogrotate script
obLOGGINGroot = "logger|newsyslog|pflogd|pkill|syslogd"
obLOGINroot = "getcap|login_pass"
obLOGIN2FAroot = "getcap|login_-tot|login_pass"
lxLXCroot = "lxc-apparmor-lo|lxc-autostart|lxc-containers|lxc-net"
obMAILroot = "mail\[|mail\.local|sendmail|smtpctl|smtpd"
obMANDOCroot = "groff|grotty|makewhatis| man\[|mandoc|troff"
obMARIADBroot = "my_print_defaults|nice"
obMISCroot = "bioctl|calendar|cron\[|crontab|cvs\[| dd\[| df\[|diff|domainname|echo|egrep| jot\[|locate|mtree|printf| pwd\[|shutdown|strip| sync\[|tail|uptime| w\[|wall| wc\["
lxNETWORKroot = "brctl|bridge|ebtables\[|ebtables-(restor|save)|ip6tables-(resto|save)| ip\[|ipset\[|iptables-(restor|save)|net-interface-h| nft\[| ss\[|start-networkin| tc\["
obNETWORKroot = " ftp\[|identd|ifconfig|netstat|ntpd|pfctl|resolvd|route|rsync|slaacd|tcpdump"
lxPKGroot = "apt-compat|apt-config|apt-get|apt-helper|dpkg\[|dpkg-db-backup"
POSTFIXroot = "master|postconf|postdrop|postfix\[|postfix-script|sendmail"
obPROXMOX_GUESTroot = " gpg-agent| qemu-ga| scdaemon"
lxPVEroot = "ksmtuned|pmxcfs|psimon|pve-bridge|pve-firewall\[|pve-firewall-co|pve-ha-crm|pve-ha-lrm|pve-sdn-commit|pve-startall-de|pvebanner|pvecm|pvedaemon|pveproxy|pvescheduler|pvesh|pvestatd\[| qm\[|qmeventd|query-machine-c|spiceproxy|startup-checks\.|syncfiles\.pl|task UPID:pve:0|termproxy"
obSAMBAroot = "nmbd|rpcd_classic|rpcd_epmapper|rpcd_fsrvp|rpcd_lsad|rpcd_mdssvc|rpcd_spoolss|rpcd_winreg|samba-bdqd|samba-dcerpcd|smbcontrol|smbd"
lxSYSTEMDroot = "30-systemd-envi|apt\.systemd\.dai|sd-close|sd-exec-strv|sd-mkdcreds|sd-mkuserns|sd-pam|sd-rmrf|\(sd-sync\)|systemctl|systemd\[|systemd-detect-|systemd-rfkill|systemd-run|systemd-sysctl|systemd-tmpfile|systemd-tty-ask|systemd-user-ru|systemd-user-se|systemd-xdg-aut"
SHELLSroot = "bash\[| csh\[| ksh\[| sh\["
lxSHELLSroot = "bash| sh\["
obSPAMDroot = "spamd\[|spamd-setu|spamdb"
obSSHDroot = "ssh-agent|sshd\[|sshd-session"
lxSSHDroot = "sshd\[|\(sshd\)|sshd-session"
obTTYroot = "getty| stty\[|tset| tty\["
obUNBOUNDroot = "unbound\[|unbound-anchor|unbound-checkconf|unbound-conf"
obWEBSERVERroot = " httpd| slowcgi"
## macOS (no [pid] after command in process accounting logs)
macCOREroot = "launchctl |launchd |launcher |launchserv | lsd |system_ins |system_pro |systemmigr |systemsoun |systemstat |warmd |watchdogd "
macCOREuser = "launcher | lsd |system_pro |warmd_agen "
macCOREUTILSroot = "basename | cat |chmod |chown | cp | curl | cut |dirname | env |find | grep | head |less | ls | lsof |mkdir |mktemp | more | mv | ps | pwd | rm |rsync | sed | seq |shutdown |stat |stty |sysctl | tee | top |touch | tr |true |which |xattr "
macCOREUTILSuser = " awk |basename | cat | cp |date |dirname | env |find | grep | head |less | ls |mkdir |more | ps | pwd | sed | seq |sleep |stty |tail | tee |touch | tr |true | w | wc "
macACCTroot = "accton |lastcomm | sa "
macANALYTICSroot = "digest-ser |ecosystema |ecosystemd |osanalytic |ospredicti |rtcreporti |signpost_r |symptomsd- |triald_sys "
macAPPS = "AddressBoo |Calendar |CalendarFi |CalendarIn |CalendarTh |CalendarWi |Contacts |Dictionary | Dock |DockHelper |FaceTimeEx |Finder |GarageBand |HomeEnergy |HomeWidget |IMDMessage |Keynote | Mail |MailCacheD |MailStorag |Maps |Messages |Messages S |MessagesAc |MessagesAi |MessagesAn |MessagesHe |MusicCache |MusicStora |NewsTag |NewsToday2 |NewsTodayI |Notes |Numbers |Pages |Photos |PhotosReli |PhotosStor |PodcastCon |PodcastWi |Preview |SafariAssi |SafariBook |SafariConf |SafariLaun |SafariLink |SafariWidg |ScreenTime |Spotlight |StocksKitS |StocksWidg |Terminal |TimeMachin |WeatherInt |WeatherWid |WorldClock |com\.apple\. |contactsd |contactsdo |homed |homeenergy |mapspushd |mapssynd |photoanaly |photolibra |weatherd "
macAPPSsubset = "CalendarIn |CalendarWi | Dock |Finder |HomeEnergy |HomeWidget |MailCacheD |MessagesAc |MessagesAi |MessagesAn |MusicCache |NewsTag |NewsToday2 |NewsTodayI |PhotosReli |PodcastsWi |SafariAssi |SafariBook |SafariConf |SafariLaun |SafariLink |SafariNoti |SafariWidg |ScreenTime |Spotlight |StocksKitS |StocksWidg |Terminal |WeatherInt |WeatherWid |WorldClock |com\.apple\. |contactsd |homed |homeenergy |mapssyncd |photoanaly |photolibra |spotlightk |weatherd "
macARCHIVEroot = "bsdtar |bzip2 | zcat"
# AUHelperService, SandboxedServiceRunner
macARCHIVEuser = "Archive Ut |AUHelperSe |Quarantine |SandboxedS |unzip "
macBACKUProot = "backupd |backupd-he "
macBANKTIVITY_APP = "installerT |Banktivity "
macCHROME_APP = "Google Chr |GoogleUpda |chrome_cra |ksadmin |ksinstall"
macCLOUDroot = "AssetCache |CloudTelem |FindMyMacd |cloudd |findmybeac |findmydevi "
macCLOUDuser = "AssetCache |CloudDocsS |CloudKeych |CloudStora |CloudTelem |CloudWorke |FindMyWidg |cloudd |cloudphoto |findmyloca |iCloudNoti |icloudmail |itunesclou "
macDEV = "clang |emacs-| git |git-remote |make |mandoc |perl | ruby |swift-insp |xcode-sele |xcrun "
macDEVICESroot = "AppleDevic |NANDTaskSc |WiFiAgent |WiFiCloudA |WirelessRa |biometrick |bluetoothd |deviceinte |nvram |usbcteleme |usbsmartca |wifianalyt |wifip2pd |wifiveloci "
macDISKroot = "apfs\.util |apfsd |diskarbitr |diskimages |fsck_apfs |fsck_hfs |hdiejectd |hdiutil |hfs\.util |searchpart |storagekit "
macFIREFOX_APP = "Firefox GP |firefox |org\.mozill "
macFSroot = "UVFSServic |autofsd |automount |automountd |corestorag |filecoordi |fseventsd |fskit_help |fskitd |mount |mount_apfs |mount_hfs |newfs_apfs |ntfs\.util |udf\.util |vsdbutil |xartutil "
macGOOGLE = "GoogleUpda |ksadmin |ksinstall "
macIDENTITYroot = "AppSSODaem |AppleCrede |GSSCred | akd |apsd |lastatus |od_user_ho |opendirect |profiles |usermanage "
macKEEPASS_APP = "KeePassXC |keepassxc- "
macLOGGINGroot = "CrashRepor |ReportCras |SubmitDiag |logd |logd_helpe |logd_repor |logger |newsyslog |sessionlog |spindump |sysdiagnos |syslog |syslogd "
macLOGGINGuser = "ReportCras |spindump_a "
macMDMroot = "Installer |ManagedCli |betaenroll |eligibilit |install_mo |managedapp |mdmclient |online-aut "
macMEDIAroot = "ANECompile |ANEStorage |AirPlayXPC |AudioCompo |IOMFB_bics |ImageIOXPC |MTLCompile |audioanaly |audioclock |corecaptur |iconservic |mediaremot "
macNETWORKroot = "airportd |mDNSRespon |nehelper |nesessionm |rpcsvchost |socketfilt "
macOBJSEE = "BlockBlock | Lulu "
macOFFICE_APPS = "codesign |launchctl |Microsoft "
macPOSTFIXroot = "master |postconf |postdrop |postfix |postfix-script |sendmail "
macPOWERroot = "PerfPowerS |PerfPowerT |PowerUIAge |peakpowerm |powerd |powerdatad |powerexper |thermalmon |threadradi "
macPRINTERroot = "cupsd |cups-exec| cups-devic | ipp |printtool "
macPRINTERuser = "AddPrinter |Print Cent |PrintCente |PrinterSca |commandInk |cups-exec|ipp2ppd |printtool |snmp "
macRUNTIMEroot = "containerm |contextsto |extensionk |netavark |runningboa |sharedfile | smd "
macRUNTIMEuser = "containerm |extensionk |sharedfile "
macSECURITYroot = "XProtect |XProtectBr |XProtectPl |XProtectRe |XProtectUp |XprotectSe |amfid |authd |authorizat |coreauthd |csrutil |sandboxd |securityd |securityd_ |spctl | sudo |syspolicyd |taskgated- |tccd |trustdFile "
macSECURITYuser = "CSUserAgen |Passwords |PasswordsS |SecurityPr |Touch ID &|XProtect |XProtectPl |XProtectRe |XprotectSe |coreautha |coreauthd |lockdownmo |tccd |trustd "
macSHELLS = " bash | sh | zsh "
macSIRI = "SiriAUSP |SiriSugges |SiriTurnRe |SiriUserSe |siriaction |siriinfere |siriknowle |sirittsd "
macSLACK_APP = "Slack |Slack Help |web_app_sh "
macSPOTLIGHTroot = " mds |mdsync "
macSPOTLIGHTuser = "corespotli |mdbulkimpo |mdfind |mdworker |mdworker_s |mdwrite |spotlightk "
macSSHuser = " scp | ssh |ssh-agent "
macSUBLIME_APP = "sublime_te |plugin_hos "
macTURBOTAXuser = "TurboTax 2 |fileop |security_a "
macUPDATEroot = "RosettaUpd |SoftwareUp |Software U |bootinstal |efilogin-h |mmaintenan |nsattribut |universala "
macUPDATEuser = "SoftwareUp |nsattribut |universala "
macUSERroot = "DesktopSer |UserEventA |UserSelect |ViewBridge |WindowServ |logind |loginwindo | wall |wallpapere "
macVMWAREroot = "vmnet-brid |vmnet-cli |vmnet-dhcp |vmnet-natd |vmware-id |vmware-usb "
macVMWARE_FUSION_APP = "Open VMwar |VMware Fus |com\.vmware |vmware-vmx "

host_1 = "10\.0\.0\.1":append
computer_1_mac_addr = "ae:f0:b4:3b:83:a7":append
ssh_pub_key_1 = "JdufjdfFJUefenffdsjJJSJ":substitute
TLS_1_2 = "TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256":substitute
TLS_1_3 = "TLSv1.3:TLS_AES_256_GCM_SHA384:256":substitute
knownfingerprint1 = "SHA256:fpstring":substitute
knownfingerprint2 = "SHA256:fpstring":substitute

# For each log to monitor, give the following:
# log: [<logpath>]
# match: [all|/<regexp>/] (default all)
# exclude: [none|/<regexp>/] (default none)
# frequency: [all|daily|hourly] (default all)
# action: [notify <email>|text <email>|alert|execute <script>] (default notify [master_notify email])
# You may also add an "execute <script>" action to any of the other
# three actions on the same "action:" line after a semicolon, e.g.,
# action: notify <email>; execute <script>
# This is useful when you want to both notify AND collect data from
# a notification for another purpose (e.g., collecting IP addresses,
# host names, mail certificate fingerprints, etc. from logs).
#
# Multiple sets of match/exclude/action directives can be specified
# for each log.
# notify requires one or more email addresses (separated by commas), which
# will be sent a report.
# text requires one or more email addresses (separated by commas), which
# will be sent the raw logs (e.g., for text messaging).
# alert takes no additional arguments and displays output directly
# to STDOUT.
# execute takes the name of a script which must be located in a subdirectory
# under the config file directory names "scripts" and must be signed with
# the signify key defined in the config, it will be passed the matching log
# lines via STDIN.

# Can define settings for multiple hosts in one file shared across multiple
# systems by using:
# hosts: [<host name list, space separated>]
# to identify which sections apply to which hosts.
# Old style multi-host configs are also still supported using:
# begin-host: [<hostname>]
# and
# end-host: [<hostname>]
# but that style requires significant redundancy for similarly configured
# systems. The two styles cannot be mixed.

### BEGIN /var/log/messages
log: /var/log/messages
match: /violation|fail|reject|denie|deny|refused|bsd: OpenBSD|sensorsd.*exceed|error|Error|Condition/
exclude: /newsyslog.*: logfile turned over/
action: notify admin@domain
### END /var/log/messages

### BEGIN /var/log/snort/portscan.log
log: /var/log/snort/portscan.log
match: all
exclude: none
action: notify admin@domain
### END /var/log/snort/portscan.log

### BEGIN /var/log/secure
log: /var/log/secure
match: all
exclude: /logfile turned over/
action: notify admin@domain
### END /var/log/secure

### BEGIN journal syslog-id doas (Linux)
log: journal syslog-id doas
match: /not permitted/
exclude: none
action: notify admin@domain
### END journal syslog-id doas (Linux)

### BEGIN /var/log/authlog
log: /var/log/authlog
match: /ROOT|sshd.*Connection|refused|deny|admin login|panic/
exclude: /ROOT LOGIN .* ON ttyC0|Threshold adjusted/
action: notify admin@domain

match: /snort/
exclude: none
action: notify admin@domain
### END /var/log/authlog

### BEGIN journal syslog-facility authpriv (Linux)
log: journal syslog-facility authpriv
match: /ROOT|refused|deny|panic/
exclude: /ROOT LOGIN .* ON tty1/
### END journal syslog-facility authpriv (Linux)

### BEGIN journal unit ssh.service (Linux)
log: journal unit ssh.service
match: /sshd.*Connection|Failed|invalid|not permitted|not from a permitted|refused|deny|admin login|panic/
exclude: /sshd.*Accepted keyboard-interactive\/pam for <knownuser> from <known-host>/
action: notify admin@domain
### END journal unit ssh.service (Linux)

### BEGIN /var/log/daemon
# example: ntpd, unbound, nsd, dhcpd
log: /var/log/daemon
match: /way too large|sanity|bad peer|terminating|exiting|unbound|nsd|dhcpd.*unknown/
exclude: /newsyslog.*: logfile turned over/
action: notify admin@domain
### END /var/log/daemon

### BEGIN journal syslog-facility daemon (Linux)
log: journal syslog-facility daemon
match: /way too large|sanity|bad peer/
exclude: none
action: notify admin@domain
### END journal syslog-facility daemon (Linux)

### BEGIN /var/log/maillog
# OpenSMTPD maillogs - non-session lines
log: /var/log/maillog
match: /reject|warn|error|panic|deny|fail|timeout|fatal|unverified|alert|bad certificate|bad signature/
# intentional error next line
exclude: /[a-f0-9]{16} (mda|mta|smtp)
action: notify admin@domain

# OpenSMTPD maillogs - mda logs (all single-line sessions)
match: /[a-f0-9]{16} mda
exclude: /result=Ok stat=Delivered/
action: notify admin@domain

# Provide context around these by matching other lines containing the
# envelope ID. The match: session-with matches all lines with a session
# ID, the exclude session-without line then removes any matching collections
# that don't include the requisite error components for the same session ID.
match: session-with /[a-f0-9]{16} (?:mta|smtp)/
exclude: session-without /([a-f0-9]{16}) (?:mta|smtp) (?:.*reject|warn|error|panic|deny|fail|timeout|fatal|invalid|bad signature|tls_ciphers=(?!%%TLS_1_3%%|%%TLS_1_2%%)|cert-check result=\"(?:valid|verified|unverified)\" fingerprint=\"(?!%%knownfingerprint1%%|%%knownfingerprint2%%).*\"))/
action: notify admin@domain
### END /var/log/maillog

### BEGIN journal unit postfix.service (Linux)
log: journal unit postfix.service
match: /reject|warning|error|panic|deny|fail|timeout|fatal/
exclude: none
action: notify admin@domain
### END journal unit postfix.service (Linux)

log: /var/log/ntp
match: /way too large/
exclude: none
action: notify admin@domain

### BEGIN /var/www/logs/access.log
log: /var/www/logs/access.log
match: /strings-associated-with-admin|404/
exclude: /authenticated-users/
action: notify admin@domain
### END /var/www/logs/access.log

### BEGIN /var/www/logs/error.log
log: /var/www/logs/error.log
match: all
exclude: none
action: notify admin@domain
### END /var/www/logs/error.log

### BEGIN /var/account/acct
# BSD process accounting logs
# first, match anything from unknown users
log: /var/account/acct
match: all
exclude: /(__|tty..) (_dhcp |_file |_identd |_nsd |_ntp |_pflogd |_ping |_pkgfetch |_rad |_reportnew |_sigtree |_slaacd |_smtpd |_smtpq |_sndio |_spamd |_syslogd |_syspatch |_tcpdump |_traceroute |_unbound |user1 |nobody |root |sshd |www )/
action: notify admin@domain

# then, pledge and unveil violations
match: /^.*\[\d+\]\s+-\w+(P|U)/
exclude: none
action: notify admin@domain

# then, any unexpected commands from known users
match: /_dhcp/
exclude: /dhcpleased|dhcrelay/
action: notify admin@domain

match: /_file/
exclude: / file\[/
action: notify admin@domain

match: /_identd/
exclude: / identd/
action: notify admin@domain

match: /_nsd/
exclude: / nsd/
action: notify admin@domain

match: /_ntp/
exclude: / ntpd/
action: notify admin@domain

match: /_pflogd/
exclude: / pflogd/
action: notify admin@domain

match: /_pkgfetch/
exclude: / ftp/
action: notify admin@domain

match: /_ping/
exclude: / ping\[|ping6/
action: notify admin@domain

match: /_rad /
exclude: / rad\[/
action: notify admin@domain

match: /_reportnew /
exclude: / perl\[| smtpctl/
action: notify admin@domain

match: /_sigtree /
exclude: / ls\[|perl\[/

# match: /_rsyncu /
# exclude: / bash\[| doas\[| perl\[| rsync| sendmail| sh\[| smtpctl| sshd\[| sshd-session/
# action: notify admin@domain

match: /_slaacd/
exclude: / slaacd/
action: notify admin@domain

match: /_smtpd/
exclude: / mail\.mboxf| sh\[| smtpctl| smtpd/
action: notify admin@domain

match: /_smtpq/
exclude: / smtpd/
action: notify admin@domain

match: /_sndio /
exclude: / sndiod/
action: notify admin@domain

match: /_spamd /
exclude: /ftp\[|pfctl| spamd|spamlogd/
action: notify admin@domain

match: /_syslogd/
exclude: / syslogd/
action: notify admin@domain

match: /_syspatch/
exclude: / cksum| ftp| sh\[| signify/
action: notify admin@domain

match: /_tcpdump/
exclude: / tcpdump/
action: notify admin@domain

match: /_traceroute/
exclude: / traceroute/
action: notify admin@domain

match: /_unbound/
exclude: / unbound/
action: notify admin@domain

match: /user1/
exclude: / basename|calc|chgrp| cp\[/
action: notify admin@domain


match: /root/
exclude: /%%ACCTroot%%|%%ARCHIVEroot%%|auth|%%obBOOTroot%%|%%COREUTILSroot%%|%%obCRYPTOroot%%|%%obDISKFSroot%%|%%obLOGGINGroot%%|%%obLOGINroot%%|%%obMANDOCroot%%|%%obMAILroot%%|%%obMISCroot%%|%%obNETWORKroot%%|%%SHELLSroot%%|%%obSSHDroot%%|%%obTTYroot%%/
action: notify admin@domain
### END /var/account/acct

### BEGIN /var/account/acct (macOS process accounting)
# This sample is for a macOS system.
# If this is the only log you monitor on macOS, you can run from a
# nonprivileged account.
# macOS seems to be more likely to display ?? for a tty in lastcomm
# output, so it's covered in the exclude on the rule for finding unknown
# users.
log: /var/account/acct
match: all
exclude: /(__|ttys\d+|\?\?) (_accesso |_analyti |_appinst |_appleev |_applepa |_assetca |_audiomx |_biome |_captive |_cmiodal |_coreaud |_corespe |_ctkd |_datadet |_diagnos | |_diskima |_distnot |_driverk |_fpsd |_gamecon |_hidd |_iconser |_install |_locatio |_lp |_mdnsres |_mds_sto |_modelma |_nearbyd |_netbios |_network |_neurale |_nsurlse |_oahd |_postfix |_reportm |_reportn |_reports |_rmd |_securit |_softwar |_spotlig |_timed |_trustd |_usbmuxd |_windows |nobody |root |unuseduser |user | adminuser )/

# _accessoryupdater
match: /_accesso /
exclude: /EAUpdaterS |UARPAssetM |XPCKeychai |accessoryu|cfprefsd |com\.apple\.|contactsd|containerm|distnoted| secd |secinitd |Thunderbol |trustd |UARPUpdate|uarpassetm|uarpd |xpcproxy /
action: notify admin@domain

# _analyticsd
match: /_analyti /
exclude: /analyticsd/
action: notify admin@domain

# _appinstalld
match: /_appinst /
exclude: /appinstall|cfprefsd |contactsd|distnoted|xpcproxy /
action: notify admin@domain

# _appleevents
match: /_appleev /
exclude: /appleevent|contactsd|distnoted|xpcproxy /
action: notify admin@domain

# _applepay
match: /_applepa /
exclude: /cfprefsd|contactsd|distnoted |NFStorageS | nfcd | seld |xpcproxy /
action: notify admin@domain

# _assetcache
match: /_assetca /
exclude: /AssetCache/
action: notify admin@domain

# _audiomxd
match: /_audiomx /
exclude: /audiomxd |cfprefsd|contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /_biome /
exclude: /biomed/
action: notify admin@domain

# _captiveagent
match: /_captive /
exclude: /captiveage/
action: notify admin@domain

# _cmiodalassistants
match: /_cmiodal /
exclude: /appleh16ca|cameracapt|cfprefsd|com\.apple\.|contactsd|containerm|distnoted| secd |secinitd |trustd |UVCAssista |xpcproxy /
action: notify admin@domain

# _coreaudiiod
match: /_coreaud /
exclude: /AppleDevic |com\.apple\.|contactsd|coreaudiod|distnoted|xpcproxy /
action: notify admin@domain

# _corespeechd
match: /_corespe /
exclude: /corespeech/
action: notify admin@domain

match: /_ctkd /
exclude: / ctkd /
action: notify admin@domain

# _datadetectors
match: /_datadet /
exclude: /DataDetect |xpcproxy /
action: notify admin@domain

# _diagnosticservicesd
match: /_diagnos /
exclude: /diagnostic|xpcproxy /
action: notify admin@domain

# _diskimagesiod
match: /_diskima /
exclude: /diskimages|xpcproxy /
action: notify admin@domain

# _distnote
match: /_distnot /
exclude: /distnoted/
action: notify admin@domain

# _driverkit
match: /_driverk /
exclude: /com\.apple\.|IOUserBlue|xpcproxy /
action: notify admin@domain

match: /_fpsd /
exclude: /adid |fairplayd/
action: notify admin@domain

# _gamecontrollerd
match: /_gamecon /
exclude: /GameContro |contactsd |distnoted |gamecontro |xpcproxy /
action: notify admin@domain

match: /_hidd /
exclude: / hidd /
action: notify admin@domain

# _iconservices
match: /_iconser /
exclude: /iconservic/
action: notify admin@domain

# _installassistant, _installer, _installcoordinationd
match: /_install /
exclude: /cfprefsd|contactsd|containerm|distnoted|installcoo | pkd |xpcproxy /
action: notify admin@domain

# _locationd
match: /_locatio /
exclude: /XPCKeychai |cfprefsd |com\.apple\. |contactsd |containerm |distnoted |locationd | secd |secinitd |trustd |xpcproxy /
action: notify admin@domain

match: /_lp /
exclude: /bluetooth |cfprefsd |cgpdftoras |contactsd |cups-devic |cups-drive |cups-exec |distnoted |epsonfax |xpcproxy /
action: notify admin@domain

# _mdnsresponder
match: /_mdnsres /
exclude: /mDNSRespon/
action: notify admin@domain

# _mds_stores (Spotlight File Metadata Index Daemon)
match: /_mds_sto /
exclude: /mds_stores|xpcproxy /
action: notify admin@domain

# _modelmanagerd
match: /_modelma /
exclude: /cfprefsd|contactsd|distnoted|HostInfere|modelmanag |xpcproxy /
action: notify admin@domain

match: /_nearbyd /
exclude: /nearbyd/
action: notify admin@domain

match: /_netbios /
exclude: /netbiosd|xpcproxy /
action: notify admin@domain

# _neuralengine
match: /_neurale /
exclude: /ANEStorage|aneuserd|cfprefsd|contactsd|distnoted|xpcproxy /
action: notify admin@domain

# _nsurlsessiond
match: /_nsurlse /
exclude: /STExtracti |cfprefsd|com\.apple\.|contactsd|distnoted|nsurlsessi|xpcproxy /
action: notify admin@domain

match: /_oahd /
exclude: / oahd |oahd-helpe/
action: notify admin@domain

match: /_postfix /
exclude: /cleanup |pickup |qmgr |showq |smtp |tlsmgr |trivial-re /
action: notify admin@domain

# _reportmemoryexception
match: /_reportm /
exclude: /ReportMemo |xpcproxy /
action: notify admin@domain

# _reportnew
match: /_reportn /
exclude: /perl /
action: notify admin@domain

# _reportsystemmemory
match: /_reports /
exclude: /ReportSyst|xpcproxy /
action: notify admin@domain

match: /_rmd /
exclude: /cfprefsd|contactsd|DiskManage|distnoted|Interactiv|LegacyProf|ManagedApp|ManagedCon|Management|PasscodeSe|remotemana|ScreenShar|SecuritySu|SoftwareUp|xpcproxy /
action: notify admin@domain

# _securityagent
match: /_securit /
exclude: /cfprefsd|contactsd|distnoted|MTLCompile |SecurityAg |xpcproxy /
action: notify admin@domain

# _softwareupdate
match: /_softwar /
exclude: /NRDUpdated |SoftwareUp |bosUpdateP |cfprefsd|com\.apple\. |contactsd|distnoted|nsattribut |softwareup|xpcproxy /
action: notify admin@domain

# _spotlight
match: /_spotlig /
exclude: /contactsd |distnoted |mdworker |mdworker_s| secd |trustd |xpcproxy /
action: notify admin@domain

match: /_timed /
exclude: /timed/
action: notify admin@domain

match: /_trustd /
exclude: / trustd /
action: notify admin@domain

match: /_usbmuxd /
exclude: / usbmuxd /
action: notify admin@domain

match: /_windows /
exclude: /contactsd|distnoted|xpcproxy /
action: notify admin@domain

match: /nobody /
exclude: /dhcp6d |xpcproxy /
action: notify admin@domain

match: /root /
exclude: /%%macCOREroot%%|%%macCOREUTILSroot%%|ASPCarryLo |CVMServer |Categories |ContextSer |InternetSh |KernelEven |MCXDiskSet |PlugInLibr |SCHelper |%%macACCTroot%%|%%macANALYTICSroot%%|%%macARCHIVEroot%%|activateSe |aned |applekeyst |applessdst |aslmanager |assetsubsc |background |%%macBACKUProot%%|%%macCLOUDroot%%|cfprefsd |colorsync. |colorsyncd |com\.apple\. |com.object |configd |contactsd |corebright |coreduetd |corekdld |corerepair |coreservic |coresymbol |countryd |cryptexd |ctkahp | ctkd |%%macDEV%%|%%macDEVICESroot%%|%%macDISKroot%%| dasd |defaults |deleted_he |dirhelper |distnoted |dprivacyd |endpointse |%%macFSroot%%|familycirc |gamepolicy |getconf |gktool |griddatad | heap |%%macIDENTITYroot%%|imklauncha |installd |kernelmana |kextstat |keybagd |killall |kmutil |%%macLOGGINGroot%%|liquiddete |locale |logkextloa |lsregister |%%macMDMroot%%|%%macMEDIAroot%%|microstack |mobileacti |mobileasse |modelcatal |%%macNETWORKroot%%|nbagent |nbstated |notifyd |%%macPOSTFIXroot%%|%%macPOWERroot%%|%%macPRINTERroot%%|pfd | pkd |%%macRUNTIMEroot%%|remoted |revisiond |%%macSECURITYroot%%|%%macSHELLS%%|%%macSPOTLIGHTroot%%|secinitd |seputil |shove |smb-sync-p |suhelperd |sw_vers |sysextd |sysmond | tzd |%%macUPDATEroot%%|%%macUSERroot%%| uncd |%%macVMWAREroot%%|writeconfi |xpcproxy /
action: notify admin@domain

match: /unuseduser /
exclude: /%%macSPOTLIGHTuser%%|cfprefsd |contactsd|containerm|distnoted| lsd | pkd | secd |trustd |xpcproxy /
action: notify admin@domain

match: /user /
exclude: /%%macAPPS%%|%%macARCHIVEuser%%|ABAssistan |AMPArtwork |AMPDeviceD |AMPLibrary |AOSHeartbe |APFSUserAg |ASConfigur |AUCrashHan |AXVisualSu |Accessibil |AccountSub |AirPlayUIA |AirScanSca |AppPredict |AppSSOAgen |AppleIDSet |AppleSpell |Applicatio |AquaAppear |AssetMetri |AudioCompo |Audiovisua |Authentica |Automator |AvatarPick |Background |BatteriesA |BiomeAgent |BiomeSELFI |BitacoraWo |BooksStora |CGPDFServi |%%macCHROME_APP%%|CMFSyncAge |CSExattrCr |CVMCompile |CacheDelet |CallHistor |Categories |ClassroomS |CommCenter |ContextSer |ContextSto |Continuity |ControlCen |CoreLocati |CoreServic |CoreThread |Credential |CursorUIVi |DPSubmissi |DataDetect |DefaultExt |DeveloperS |DeviceProp |DiskImageM |DiskUnmoun |DisplayCon |EscrowSecu |Experiment |FPCKServic |FSKitModul |Family |FamilySett |FeatureAcc |FedStatsML |FollowUpSe |GMSSELFIng |GPGSuite_U |GeneralSet |HeadphoneS |IFTelemetr |IFTranscri |IMAutomati |IMDPersist |IMTranscod |IMTransfer |Image Capt |ImageIOXPC |ImageThumb |InferenceE |Install in |Installer |InstallerT |Intelligen |Interactiv |JournalWid |Keychain C |KeychainSt |KonaSynthe |LWAnalytic |LegacyPlug |LegacyProf |LocalAuthe |LoginItems |LoginUserS |MENotifica |MTLAssetUp |MTLCompile |MacPodcast |MacinTalkA |Managed Ba |ManagedApp |ManagedSet |Management |MauiAUSP |MediaExten |MediaMLExt |MetricsExt |MobileTime |ModelCatal |MonogramPo |Network |Notificati |ODDIExperi |ODDIMetric |ODDIPoirot |OfficeThum |OtherUsers |PAH_Extens |PackageThu |PasscodeSe |PasswordBr |PeopleWidg |PlugInLibr |PnROnDevic |Problem Re |ProtectedC |QuickLookS |QuickLookU |RecordWidg |RemoteCata |RemoteMana |Repackagin |RemindersW |SAExtensio |ScopedBook |ScreenShar |SecurityAg |SecuritySu |SetStoreUp |SettingsSy |ShortcutsV |ShortcutsW |SoftwareUp |SpeechData |SpeechSynt |StatusKitA |StorageMan |System Inf |System Set |SystemUISe |TMHelperAg |TVCacheExt |TVStorageE |TelemetryA |TextInputM |TextInputS |TextThumbn |ThemeWidge |TipsWidget |TrashStora |TrialArchi |TrustedPee |UIKitSyste |UniversalC |UsageTrack |UserEventA |UserNotifi |UserSelect | VPN |VTDecoderX |VTEncoderX |ViewBridge |VoiceMemos |WallpaperA |WardaSynth |WebThumbna |Wi-Fi |WiFiAgent |WiFiCloudA |WindowMana |XPCKeychai |accountsd |adprivacyd | akd |amsaccount |amsengagem |amsondevic |analyticsa |appleaccou |appplaceho |appstoreag |askpermiss |assistant_ |assistantd |audioacces |avatarsd |avconferen |axassetsd |background |betaenroll |biomesyncd | bird |bluetoothu |businessse |%%macCHROME_APP%%|%%macCLOUDuser%%|%%macCOREUTILSuser%%|calaccessd |callintell |callservic |cdpd |cfprefsd |chronod |ciphermld |colorsync\. |commerce |communicat |contentlin |corespeech |crashhelpe |csnameddat |ctkahp | ctkd |dataaccess |defaults |deleted |destinatio |devicechec |diagnostic |diskarbitr |diskimages |distnoted | dmd |donotdistu |dprivacyd |duetexpert |ecosystema |exchangesy |familycirc |feedbackd |fileprovid |filevaultd |financed |%%macFIREFOX_APP%%|followupd |fontd |fontworker |frauddefen |fskit_agen |fudHelperA |gamecontro |gamed |generative |geoanalyti |geodMachSe |go-nfsv4-1 |hdiutil |helpd |iOSFilesSt | icdd |iconservic |identityse |imagent |imklauncha |inputanaly |installera |intelligen |intents_he |jetpackass |keyboardse |keychainsh |knowledge- |knowledgec |%%macLOGGINGuser%%|linkd |liveactivi |locale |localizati |localspeec |login |loginitemr |maild |managedapp |managedcor |mandoc |mbuseragen |mdmclient |media-inde |mediaanaly |mediaremot |metrickitd |migrationh |milod |mlhostd |mlruntimed |mobilerepa |mobiletime |mount |mount_hfs |mscamerad |mscamerad- |naturallan |nbagent |ndoagent |neagent |networkser |nsattribut |nsurlsessi |otherbsd |%%macPRINTERuser%%|parsec-fbf |parsecd |passd |path_helpe |pboard | pbs |peopled |pingsender | pkd |pkgutil |pkreporter |plugin-con |postersync |privateclo |proactived |proactivee |profiles |progressd |promotedco |ptcamerad |%%macRUNTIMEuser%%|rapportd |recentsd |remindd |replayd |replicator |reversetem |routined |%%macSECURITYuser%%|%%macSHELLS%%|%%macSIRI%%|%%macSSHuser%%|%%macSPOTLIGHTuser%%|screencapt |searchpart | secd |secinitd |securityup |seedusaged |seserviced |sharingd |shazamd |shlock |sociallaye |storekitag |studentd |suggestd | swcd |swtranspar |syncdefaul |systemsett |talagentd |textunders |tipsd |translatio |transparen |triald |umount |universala |useractivi |usernoted |usernotifi |%%macVMWARE_FUSION_APP%%|voicebanki |webprivacy |xattr |xcode-sele |xpcproxy | zcat /
action: notify admin@domain

match: /adminuser /
exclude: /%%macAPPSsubset%%|AMPArtwork |AMPDeviceD |AMPLibrary |AOSHeartbe |APFSUserAg |ASConfigur |AUCrashHan |AXVisualSu |Accessibil |AccountSub |AddressBoo |AirPlayUIA |AppPredict |AppleSpell |AquaAppear |AssetMetri |AudioCompo |Authentica |Background |BatteriesA |BiomeAgent |BiomeSELFI |BitacoraWo |CMFSyncAge |CacheDelet |CallHistor |CarbonComp |Categories  |CommCenter |ContextSer |ContextSto |Continuity |ControlCen |CoreLocati |CoreServic |CoreThread |CursorUIVi |DeviceProp |EscrowSecu |Experiment |FeatureAcc |GMSSELFIng |GPGSuite_U |IFTelemetr |IFTranscri |IMDMessage |IMDPersist |IMTransfer |ImageIOXPC |Intelligen |Interactiv |JournalWid |Keychain C |KonaSynthe |LegacyProf |LoginUserS |MENotifica | MRT |MTLAssetUp |MTLCompile |MacinTalkA |ManagedApp |ManagedSet |Management |MauiAUSP |MediaMLExt |MetricsExt |MobileTime |ModelCatal |Notificati |ODDIExperi |ODDIMetric |ODDIPoirot |PasscodeSe |PasswordBr |PeopleWidg |PlugInLibr |PnROnDevic |ProtectedC |QuickLookU |RecordWidg |RemindersW |RemoteMana |ReportCras |SAExtensio |ScopedBook |ScreenShar |SecuritySu |SetStoreUp |ShortcutsV |ShortcutsW |SoftwareUp |SpeechSynt |StatusKitA |SystemUISe |TVCacheExt |TelemetryA |TextInputM |TextInputS |TipsWidget |TrialArchi |TrustedPee |UIKitSyste |UniversalC |UsageTrack |UserEventA |UserNotifi |VTDecoderX |ViewBridge |VoiceMemos |WallpaperA |WardaSynth |WiFiAgent |WiFiCloudA |WindowMana |accountsd |adprivacyd | akd |amsaccount |amsengagem |amsondevic |analyticsa |appleaccou |appplaceho |appstoreag |askpermiss |assistant_ |assistantd |audioacces |avconferen |axassetsd |background |betaenroll |biomesyncd | bird |bluetoothu |bsdtar |businessse |%%macCLOUDuser%%|%%macCOREUTILSuser%%|calaccessd |callservic | cdpd |cfprefsd |chmod |chronod |commerce |communicat |containerm |contentlin |corespeech |csnameddat |ctkahp | ctkd | curl |%%macDEV%%|dataaccess |deleted |devicechec |diagnostic |distnoted | dmd |donotdistu |duetexpert |ecosystema |exchangesy |extensionk |familycirc |feedbackd |fileprovid |filevaultd |financed |followupd |fontd |fontworker |frauddefen |fudHelperA |gamecontro |generative |geoanalyti |geodMachSe |getconf |helpd | icdd |iconservic |identityse |imagent |imklauncha |inputanaly |intelligen |intents_he |jetpackass |keyboardse |keychainsh |knowledge- |lastcomm |linkd |liveactivi |locale |localizati |localspeec |locationac |lockf |login |maild |managedapp |mdmclient |media-inde |mediaanaly |mediaremot |mediashari |milod |mlhostd |mobilerepa |mobiletime |naturallan |nbagent |ndoagent |neagent |networkser |nsurlsessi |otherbsd |parsec-fbf |parsecd |passd |path_helpe |pboard | pbs |pcdCheck |peopled | pkd |pkgutil |postersync |privateclo |proactived |proactivee |progressd |promotedco |rapportd |readlink |recentsd |remindd |replayd |replicator |routined |%%macSECURITYuser%%|%%macSHELLS%%|%%macSIRI%%|%%macSPOTLIGHTuser%%|searchpart | secd |secinitd |securityup |seedusaged |seserviced |sharedfile |sharingd |shlock |sociallaye | sudo |suggestd |sw_vers | swcd |swtranspar |syncdefaul |sysctl |systemsett |talagentd |tipsd |translatio |transparen |trustd |universala |useractivi |usernoted |usernotifi |voicebanki |warmd_agen |webprivacy |xpcproxy /
action: notify admin@domain

### END /var/account/acct (macOS process accounting)

### BEGIN /var/log/account/pacct (Linux process accounting)
# This sample is for a Proxmox (Debian) system.
log: /var/log/account/pacct
match: all
exclude: /(__|pts\/\d|tty\d) (_apt |_chrony |man |message\+ |postfix |_rpc |_reportnew |root |sshd |www-data )/
action: notify admin@domain

# then, any unexpected commands from known users, just as for BSD-style
match: /_apt /
exclude: / http| sqv\[ |store\[/
action: notify admin@domain

match: /_chrony /
exclude: /chronyd/
action: notify admin@domain

match: /man /
exclude: / mandb\[/
action: notify admin@domain

match: /message\+ /
exclude: /dbus-daemon/
action: notify admin@domain

# avoid matching postfix commands, we just want the user, wish it had a leading _.
match: /__ postfix /
exclude: /cleanup|pickup\[|postsuper| qmgr\[|scache| showq\[| smtp\[|tlsmgr\[|trivial-rewrite/
action: notify admin@domain

match: /_rpc /
exclude: /rpcbind/
action: notify admin@domain

match: /_reportnew /
exclude: / perl\[|postdrop|reportnew|sendmail/
action: notify admin@domain

# avoid matching sshd command, we just want the user, wish it had a leading _.
match: /__ sshd /
exclude: /sshd-auth/
action: notify admin@domain

match: /www-data /
exclude: / ip\[| pveproxy\[|pveproxy worker|spiceproxy\[|spiceproxy work/
action: notify admin@domain

match: /root /
exclude: /%%lxACCTroot%%|%%lxARCHIVEroot%%|activate-storag|%%lxCHRONroot%%|%%COREUTILSroot%%|%%lxCOREUTILSroot%%|%%lxCRYPTOroot%%|cached_setup_fo|cached_setup_te|configure-insta|d-logind|%%lxDISKROOT%%|%%lxDOCroot%%|%%lxFSroot%%|fido_id\[|grub-editenv|http\[|invoke-rc.d|%%lxIMMUTABLEroot%%|%%lxISCSIroot%%|%%lxKERNELroot%%|%%lxKVMroot%%|%%lxLANGroot%%|local|%%lxLOGGINGroot%%|login|%%lxLXCroot%%|mail\[|%%lxNETWORKroot%%|netavark|%%lxPKGroot%%|%%POSTFIXroot%%|profile-load|%%lxPVEroot%%|rsync|runlevel|setfont|%%lxSHELLSroot%%|%%lxSSHDroot%%| store\[|%%lxSYSTEMDroot%%|unix_chkpwd|update-alternat|virtual-functio/
action: notify admin@domain

### END /var/log/account/pacct
